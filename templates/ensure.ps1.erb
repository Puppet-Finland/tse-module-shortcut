$shell = New-Object -COM WScript.Shell
$shortcut = $shell.CreateShortcut("<%= @lnk_path %>")
$shortcut.TargetPath = "<%= @target %>"

<% unless @arguments.nil? -%>
$shortcut.Arguments = "<%= @arguments.gsub(%r{/}, '\\') %>"
<% end -%>
<% unless @description.nil? -%>
$shortcut.Description = "<%= @description.gsub(%r{/}, '\\') %>"
<% end -%>
<% unless @working_directory.nil? -%>
$shortcut.WorkingDirectory = "<%= @working_directory.gsub(%r{/}, '\\') %>"
<% end -%>
<% unless @icon_location.nil? -%>
$shortcut.IconLocation = "<%= @icon_location.gsub(%r{/}, '\\') %>"
<% end -%>

$shortcut.Save()
